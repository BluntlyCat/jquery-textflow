(function(t){var u=function(e,b){return b?e+Math.floor(Math.random()*(b-e)):Math.floor(Math.random()*e)},x=function(e){e=e?e:this.getDefaultDirections();this.x=e[u(e.length)].x;this.y=e[u(e.length)].y};x.prototype.directions={none:{x:0,y:0},north:{x:0,y:-1},northEast:{x:1,y:-1},east:{x:1,y:0},southEast:{x:1,y:1},south:{x:0,y:1},southWest:{x:-1,y:1},west:{x:-1,y:0},northWest:{x:-1,y:-1}};x.prototype.getDefaultDirections=function(){var e=[],b;for(b in self.directions)self.directions.hasOwnProperty(b)&&
e.push(self.directions[b]);return e};var D=function(e,b,l,p,d,h,g,m,n,c){var a=this,q=null,f=null,k=function(){a.rect={top:a.y-a.h,right:a.x+a.w,bottom:a.y,left:a.x}},v=function(){a.ax+=a.acceleration*g.x;Math.abs(a.ax)<Math.abs(a.maxAx)?q=setTimeout(v,40):a.ax=a.maxAx},A=function(){a.ax+=.1*g.x;Math.abs(a.ax)>Math.abs(a.maxAx)?f=setTimeout(A,40):(a.ax=a.maxAx,q=null)};this.x=b;this.y=l;this.maxAx=h;this.ay=this.ax=0;this.text=n;this.fontSize=c;this.font=c+"pt "+e.font;this.color=e.color;this.acceleration=
1/a.fontSize;this.w=p;this.h=d;this.vy=this.vx=0;this.rect=function(){return{top:a.y-a.fontSize,right:a.x+a.w,bottom:a.y-a.fontSize+a.h,left:a.x}};this.boostUp=function(c){a.ax+=c.fontSize/a.fontSize*(c.ax-a.ax);clearTimeout(f);clearTimeout(q);A()};this.breakDown=function(c){a.ax-=c.fontSize/a.fontSize*a.ax;clearTimeout(q);clearTimeout(f);v()};this.start=function(){v()};this.move=function(){a.vx=a.ax;a.vy=a.ay;a.x+=a.vx;a.y+=a.vy;k();0>g.x?0>a.rect.right&&m.removeElement(a):a.rect.left>m.width&&m.removeElement(a)};
k()},E=function(e,b,l,p,d,h,g,m,n,c){var a=this,q=null,f=800>=window.innerWidth?12:16,k=800>=window.innerWidth?16:20,v=function(){if(l.getElements().length<n){var d=u(f,k),h=c[u(c.length)],g,m=u(1,10)*b.x;p.txtCtx.font=d+"pt "+e.font;g=p.txtCtx.measureText(h).width;d=new D(e,0>b.x?a.width:-g,u(a.marginTop,a.height-a.marginBottom-a.marginTop-d),g,d,m,b,l,h,d);l.addElement(d);d.start()}q=setTimeout(v,u(1E3,2500))};this.width=d;this.height=h;this.marginTop=g;this.marginBottom=m;this.resize=function(c,
f){a.width=c;a.height=f};this.start=function(){v()};this.stop=function(){clearTimeout(q)}},F=function(e,b,l,p,d,h,g){var m=this,n=t("<canvas></canvas>"),c=n[0].getContext("2d"),a=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame,q=window.cancelAnimationFrame||window.mozCancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame,
f=null,k=function(){var b=l.getElements(),d,e;m.clear();for(d=0;d<b.length;d++)e=b[d],c.font=e.font,c.fillStyle=e.color,c.fillText(e.text,e.x,e.y);f=a(k)};this.resize=function(a,c){n.attr("width",b.width());n.attr("height",b.height());n.css({width:b.width()+"px",height:b.height()+"px",top:a?a+"px":0,left:c?c+"px":0})};this.txtCtx=c;this.clear=function(){var a=c.fillStyle;c.fillStyle="rgba(255, 0, 0, 1)";c.clearRect(0,0,b.outerWidth(),b.outerHeight());c.fillStyle=a};this.size=function(){return{width:b.outerWidth(),
height:b.outerHeight()}};this.start=function(){c.textAlign="start";k()};this.stop=function(){q(f);m.clear()};n.css({position:"absolute","z-index":2,background:"transparent"});b.css("background",e.background);n.appendTo(b);m.resize(p,d,h,g)},G=function(e,b,l){var p=this,d=null,h=[],g=[],m=function(c,a){var b=[c.x,c.x+c.width,a.x,a.x+a.width],f=[c.y,c.y+c.height,a.y,a.y+a.height],d=function(a,c){return a-c};b.sort(d);f.sort(d);return b[2]-b[1]>f[2]-f[1]?"x":"y"},n=function(){for(var c=0;c<h.length;c++)h[c].move();
for(c=0;c<g.length-1;c++)for(var a=g[c],b=c+1;b<g.length;b++){var f=g[b];if(!(a.rect.left>f.rect.right||f.rect.left>a.rect.right||a.rect.top>f.rect.bottom||f.rect.top>a.rect.bottom)&&"y"===m(a,f)){var k;0>e.x?(a.rect.left<f.rect.left?k=a:(k=f,f=a),k.boostUp(f),f.breakDown(k)):(a.rect.right>f.rect.right?(k=f,f=a):k=a,f.boostUp(k),k.breakDown(f))}}d=setTimeout(n,15)};this.width=b;this.height=l;this.addElement=function(c){h.push(c);g.push(c)};this.removeElement=function(c){var a=[],b,d;for(b=0;b<h.length;b++)d=
h[b],d!==c&&a.push(d);h=a;g=[];for(b=0;b<h.length;b++)d=h[b],g.push(d)};this.getElements=function(){return g};this.resize=function(b,a){p.width=b;p.height=a};this.start=function(){n()};this.stop=function(){clearTimeout(d)}},r=null,w=null,z=null,y=!1,B=function(){y||(r.start(),w.start(),z.start(),y=!0)},C=function(){y&&(r.stop(),w.stop(),z.stop(),y=!1)};t.fn.startTextFlow=function(){B()};t.fn.stopTextFlow=function(){C()};t.fn.textFlow=function(e){var b=t(this),l=null,p=null,d=t.extend({width:"100%",
height:"200px",top:0,left:0,maxTexts:15,marginTop:25,marginBottom:0,texts:["Add","your","own","texts","here"],color:"#000",background:"transparent",font:"sans-serif"},e);(function(){var e=[x.prototype.directions.east,x.prototype.directions.west];b.css({width:d.width,height:d.height,top:d.top,left:d.left,position:"relative"});if(!(d.texts instanceof Array))throw Error("Texts must be an array");p=d.texts;l=new x(e);w=new G(l,b.outerWidth(),b.outerHeight());r=new F(d,b,w,d.width,d.height);z=new E(d,
l,w,r,r.size().width,r.size().height,d.marginTop,d.marginBottom,d.maxTexts,p);b.startTextFlow()})();t(window).resize(function(){r.resize();w.resize(b.outerWidth(),b.outerHeight());z.resize(r.size().width,r.size().height)});document.addEventListener("visibilitychange",function(){y?C():B()});return this}})(jQuery);
